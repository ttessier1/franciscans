/*
 Copyright (c)2014-2020 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license   GNU General Public License version 3, or later
*/
if("undefined"===typeof akeeba)var akeeba={};"undefined"===typeof akeeba.Wizard&&(akeeba.Wizard={execTimes:[30,25,20,14,7,5,3],blockSizes:[240,200,160,80,40,16,4,2,1],translation:{}});
akeeba.Wizard.boot=function(){akeeba.Wizard.execTimes=[30,25,20,14,7,5,3];akeeba.Wizard.blockSizes=[480,400,240,200,160,80,40,16,4,2,1];document.getElementById("backup-progress-pane").style.display="block";akeeba.Backup.resetTimeoutBar();akeeba.System.doAjax({akact:"ping"},function(){akeeba.Wizard.minExec()},function(){},!1,1E4)};
akeeba.Wizard.minExec=function(a,b){null==a&&(a=0);null==b&&(b=0);akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(1E3*(2*a+5),100);document.getElementById("backup-substep").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_MINEXECTRY").replace("%s",a.toFixed(1));document.getElementById("step-minexec").className="akeeba-label--teal";akeeba.System.doAjax({akact:"minexec",seconds:a},function(d){b++;3>b?akeeba.Wizard.minExec(a,b):akeeba.Wizard.minExecApply(a)},function(){a+=0.5;20<
a?(document.getElementById("backup-progress-pane").style.display="none",document.getElementById("error-panel").style.display="block",document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTDETERMINEMINEXEC")):akeeba.Wizard.minExec(a,0)},!1,1E3*(2*a+5))};
akeeba.Wizard.minExecApply=function(a){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(25E3,100);document.getElementById("backup-substep").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_SAVEMINEXEC");akeeba.System.doAjax({akact:"applyminexec",minexec:a},function(a){a=document.getElementById("step-minexec");a.className=a.className="akeeba-label--green";akeeba.Wizard.directories()},function(){document.getElementById("backup-progress-pane").style.display="none";document.getElementById("error-panel").style.display=
"block";document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTSAVEMINEXEC")},!1)};
akeeba.Wizard.directories=function(){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(1E4,100);document.getElementById("backup-substep").innerHTML="";document.getElementById("step-directory").className="akeeba-label--teal";akeeba.System.doAjax({akact:"directories"},function(a){a?(a=document.getElementById("step-directory"),a.className=a.className="akeeba-label--green",akeeba.Wizard.database()):(document.getElementById("backup-progress-pane").style.display="none",document.getElementById("error-panel").style.display=
"block",document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTFIXDIRECTORIES"))},function(){document.getElementById("backup-progress-pane").style.display="none";document.getElementById("error-panel").style.display="block";document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTFIXDIRECTORIES")},!1)};
akeeba.Wizard.database=function(){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(3E4,50);document.getElementById("backup-substep").innerHTML="";document.getElementById("step-dbopt").className="akeeba-label--teal";akeeba.System.doAjax({akact:"database"},function(a){a?(a=document.getElementById("step-dbopt"),a.className=a.className="akeeba-label--green",akeeba.Wizard.maxExec()):(document.getElementById("backup-progress-pane").style.display="none",document.getElementById("error-panel").style.display=
"block",document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTDBOPT"))},function(){document.getElementById("backup-progress-pane").style.display="none";document.getElementById("error-panel").style.display="block";document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTDBOPT")},!1)};
akeeba.Wizard.maxExec=function(){var a=array_shift(akeeba.Wizard.execTimes);empty(akeeba.Wizard.execTimes)||null==a?(document.getElementById("backup-progress-pane").style.display="none",document.getElementById("error-panel").style.display="block",document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_EXECTOOLOW")):(akeeba.Backup.resetTimeoutBar(),akeeba.Backup.startTimeoutBar(1200*a,80),document.getElementById("step-maxexec").className="akeeba-label--teal",
document.getElementById("backup-substep").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_MINEXECTRY").replace("%s",a.toFixed(0)),akeeba.System.doAjax({akact:"maxexec",seconds:a},function(b){b?akeeba.Wizard.maxExecApply(a):akeeba.Wizard.maxExec()},function(){akeeba.Wizard.maxExec()},!1,38E3))};
akeeba.Wizard.maxExecApply=function(a){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(1E4,100);document.getElementById("backup-substep").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_SAVINGMAXEXEC");akeeba.System.doAjax({akact:"applymaxexec",seconds:a},function(){var a=document.getElementById("step-maxexec");a.className=a.className="akeeba-label--green";akeeba.Wizard.partSize()},function(){document.getElementById("backup-progress-pane").style.display="none";document.getElementById("error-panel").style.display=
"block";document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTSAVEMAXEXEC")})};
akeeba.Wizard.partSize=function(){akeeba.Backup.resetTimeoutBar();var a=array_shift(akeeba.Wizard.blockSizes);if(empty(akeeba.Wizard.blockSizes)||null==a)document.getElementById("backup-progress-pane").style.display="none",document.getElementById("error-panel").style.display="block",document.getElementById("backup-error-message").textContent=akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_CANTDETERMINEPARTSIZE");else{var b=a/8;akeeba.Backup.startTimeoutBar(3E4,100);document.getElementById("backup-substep").textContent=
akeeba.System.Text._("COM_AKEEBA_CONFWIZ_UI_PARTSIZE").replace("%s",b.toFixed(3));document.getElementById("step-splitsize").className="akeeba-label--teal";akeeba.System.doAjax({akact:"partsize",blocks:a},function(a){a?(a=document.getElementById("step-splitsize"),a.className=a.className="akeeba-label--green",akeeba.Wizard.done()):akeeba.Wizard.partSize()},function(a){akeeba.Wizard.partSize()},!1,6E4)}};
akeeba.Wizard.done=function(){document.getElementById("backup-progress-pane").style.display="none";document.getElementById("backup-complete").style.display="block"};
akeeba.Wizard.autodetect=function(a){a={akact:"pythia",folder:a};document.getElementById("varakeeba.advanced.embedded_installer").value="angie-generic";akeeba.System.doAjax(a,function(a){if("object"===typeof a){var d=a.database.driver;document.getElementById("varakeeba.platform.scripttype").value=a.cms;document.getElementById("varakeeba.advanced.embedded_installer").value=a.installer;document.getElementById("var[akeeba.platform.dbdriver]").value=d;document.getElementById("var[akeeba.platform.dbhost]").value=
a.database.host;document.getElementById("var[akeeba.platform.dbport]").value=a.database.port;document.getElementById("var[akeeba.platform.dbusername]").value=a.database.username;document.getElementById("var[akeeba.platform.dbpassword]").value=a.database.password;document.getElementById("var[akeeba.platform.dbname]").value=a.database.name;document.getElementById("var[akeeba.platform.dbprefix]").value=a.database.prefix;document.getElementById("pythiaExtradirs").innerHTML=a.extradirs.join("<br/>");for(var d=
[],c,f=0;f<a.extradb.length;f++){var e=a.extradb[f];c="<strong>Host</strong>: "+e.host;c+=" <strong>Db</strong>: "+e.name;c+=" <strong>User</strong>: "+e.username;c+=" <strong>Prefix</strong>: "+e.prefix;d.push(c)}document.getElementById("pythiaExtradb").innerHTML=d.join("<br/>");akeeba.System.triggerEvent(document.querySelector('select[id*="akeeba.platform.dbdriver"]'),"change")}});return!1};
akeeba.Wizard.onDatabaseDriverChange=function(a){a=this.value.toLowerCase();document.getElementById("host-wrapper").style.display="grid";document.getElementById("port-wrapper").style.display="grid";document.getElementById("user-wrapper").style.display="grid";document.getElementById("pass-wrapper").style.display="grid";document.getElementById("name-wrapper").style.display="grid";document.getElementById("prefix-wrapper").style.display="grid";if("sqlite"==a||"none"==a)document.getElementById("host-wrapper").style.display=
"none",document.getElementById("port-wrapper").style.display="none",document.getElementById("user-wrapper").style.display="none",document.getElementById("pass-wrapper").style.display="none",document.querySelector('input[id*="akeeba.platform.dbhost"]').value="",document.querySelector('input[id*="akeeba.platform.dbport"]').value="",document.querySelector('input[id*="akeeba.platform.dbusername"]').value="",document.querySelector('input[id*="akeeba.platform.dbpassword"]').value="";"none"==a&&(document.getElementById("name-wrapper").style.display=
"none",document.getElementById("prefix-wrapper").style.display="none",document.querySelector('input[id*="akeeba.platform.dbname"]').value="",document.querySelector('input[id*="akeeba.platform.dbprefix"]').value="")};akeeba.Wizard.onBtnBrowseClick=function(a){var b=document.getElementById("var[akeeba.platform.newroot]");akeeba.Configuration.onBrowser(b.value,b);a.preventDefault();return!1};
akeeba.Wizard.onBtnPythiaClick=function(a){a.preventDefault();a=document.getElementById("var[akeeba.platform.newroot]").value;akeeba.Wizard.autodetect(a);return!1};
akeeba.System.documentReady(function(){var a=document.querySelector('select[id*="akeeba.platform.dbdriver"]');akeeba.System.addEventListener(document.getElementById("btnBrowse"),"click",akeeba.Wizard.onBtnBrowseClick);akeeba.System.addEventListener(document.getElementById("btnPythia"),"click",akeeba.Wizard.onBtnPythiaClick);akeeba.System.addEventListener(a,"change",akeeba.Wizard.onDatabaseDriverChange);akeeba.System.triggerEvent(a,"change");null===a&&akeeba.Wizard.boot()}); //#sourceMappingURL=wizard.min.map
