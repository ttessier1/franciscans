if("undefined"==typeof akeeba)var akeeba={};"undefined"==typeof akeeba.Backup&&(akeeba.Backup={URLs:{},tag:"",backupid:null,currentDomain:null,domains:{},srpInfo:{},returnUrl:"",returnForm:"",timeoutTimer:null,resumeTimer:null,resume:{retry:0,showWarnings:0}}),akeeba.Backup.timer=function(a){0>=a&&(a=10),setTimeout(akeeba.Backup.timerTick,a)},akeeba.Backup.timerTick=function(){try{console.log("Timer tick")}catch(a){}var a=akeeba.System.getOptions("akeeba.Backup.maxExecutionTime",14),b=akeeba.System.getOptions("akeeba.Backup.runtimeBias",75);akeeba.Backup.resetTimeoutBar(),akeeba.Backup.startTimeoutBar(a,b),akeeba.System.doAjax({ajax:"step",tag:akeeba.Backup.tag,backupid:akeeba.Backup.backupid},akeeba.Backup.onStep,akeeba.Backup.onError,!1)},akeeba.Backup.startTimeoutBar=function(){var a=0;akeeba.Backup.timeoutTimer=setInterval(function(){a++;var b=document.querySelector("#response-timer div.text");b&&(b.textContent=akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s",a.toFixed(0)))},1e3)},akeeba.Backup.resetTimeoutBar=function(){try{clearInterval(akeeba.Backup.timeoutTimer)}catch(a){}var a=document.querySelector("#response-timer div.text");a&&(a.textContent=akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s","0"))},akeeba.Backup.startRetryTimeoutBar=function(){var a=akeeba.System.getOptions("akeeba.Backup.resume.timeout",10);akeeba.Backup.resumeTimer=setInterval(function(){a--,document.getElementById("akeeba-retry-timeout").textContent=a.toFixed(0),0==a&&(clearInterval(akeeba.Backup.resumeTimer),akeeba.Backup.resumeBackup())},1e3)},akeeba.Backup.resetRetryTimeoutBar=function(){clearInterval(akeeba.Backup.resumeTimer);var a=akeeba.System.getOptions("akeeba.Backup.resume.timeout",10);document.getElementById("akeeba-retry-timeout").textContent=a.toFixed(0)},akeeba.Backup.renderBackupSteps=function(a){var b="akeeba-label--green";""==a&&(b="akeeba-label--grey"),document.getElementById("backup-steps").innerHTML="";for(var c=akeeba.System.getOptions("akeeba.Backup.domains",{}),d=0;d<c.length;d++){var e=c[d],f=document.createElement("div");if(f.className=" ",f.innerHTML=e[1],akeeba.System.data.set("domain",e[0]),document.getElementById("backup-steps").appendChild(f),e[0]==a){b="akeeba-label--grey";var g="akeeba-label--teal"}else var g=b;f.className+=" "+g}},akeeba.Backup.start=function(){try{console.log("Starting backup"),console.log(data)}catch(a){}if(window.AVGRUN){try{console.warn("AVG Antivirus with Link Checker detected. The backup WILL fail!")}catch(a){}var a=confirm(akeeba.System.Text._("SOLO_BACKUP_AVGWARNING"));if(!a)return}try{null!=akeeba.Backup.commentEditorSave&&akeeba.Backup.commentEditorSave()}catch(a){document.getElementById("comment").value=""}document.getElementById("backup-setup").style.display="none",document.getElementById("backup-progress-pane").style.display="block";var b=akeeba.System.getOptions("akeeba.Backup.hasAngieKey",!1);b&&(document.getElementById("angie-password-warning").style.display="block");var c=new Date;akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPSTARTED")+" "+c.toLocaleString()),akeeba.Backup.renderBackupSteps("");var d=akeeba.System.getOptions("akeeba.Backup.maxExecutionTime",14),e=akeeba.System.getOptions("akeeba.Backup.runtimeBias",75);akeeba.Backup.startTimeoutBar(d,e),akeeba.Backup.tag=akeeba.Backup.srpInfo.tag;var f={ajax:"start",description:document.getElementById("backup-description").value,comment:document.getElementById("comment").value};f=array_merge(f,akeeba.Backup.srpInfo),akeeba.System.doAjax(f,akeeba.Backup.onStep,akeeba.Backup.onError,!1)},akeeba.Backup.onStep=function(a){try{console.log("Running backup step"),console.log(a)}catch(a){}if(akeeba.Backup.renderBackupSteps(a.Domain),akeeba.Backup.currentDomain=a.Domain,document.querySelector("#backup-percentage div.bar").style.width=a.Progress+"%",document.getElementById("backup-step").textContent=a.Step,document.getElementById("backup-substep").textContent=a.Substep,a.Warnings=a.Warnings||[],0<a.Warnings.length){var b=document.getElementById("backup-percentage").className;-1==b.indexOf("akeeba-progress--warning")&&(document.getElementById("backup-percentage").className="akeeba-progress--warning");for(var c,d=0;d<a.Warnings.length;d++){c=a.Warnings[d],akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPWARNING"),c);var e=document.createElement("div");e.textContent=c,document.getElementById("warnings-list").appendChild(e)}document.getElementById("backup-warnings-panel").style.display="block"}var f=a.Error;if(""!=f){try{console.error("Got an error message"),console.log(f)}catch(a){}return void akeeba.Backup.onError(f)}if(1==a.HasRun){try{console.log("Backup complete"),console.log(f)}catch(a){}return void akeeba.Backup.onDone()}empty(akeeba.Backup.tag)&&(akeeba.Backup.tag="backend"),akeeba.Backup.backupid=a.backupid,akeeba.Backup.resume.retry=0;var g=10;a.hasOwnProperty("sleepTime")&&(g=a.sleepTime);try{console.log("Starting tick timer with waitTime = "+g+" msec")}catch(a){}akeeba.Backup.timer(g)},akeeba.Backup.resumeBackup=function(){akeeba.Backup.resetRetryTimeoutBar(),document.getElementById("error-panel").style.display="none",document.getElementById("retry-panel").style.display="none",document.getElementById("backup-progress-pane").style.display="block",akeeba.Backup.resume.showWarnings&&(document.getElementById("backup-warnings-panel").style.display="block");var a=new Date;akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPRESUME")+" "+a.toLocaleString()),akeeba.Backup.timer()},akeeba.Backup.cancelResume=function(){akeeba.Backup.resetRetryTimeoutBar();var a=document.getElementById("backup-error-message-retry").innerHTML;akeeba.Backup.endWithError(a)},akeeba.Backup.onError=function(a){if(!akeeba.System.getOptions("akeeba.Backup.resume.enabled",!0))return void akeeba.Backup.endWithError(a);var b=akeeba.System.getOptions("akeeba.Backup.resume.maxRetries");if(akeeba.Backup.resume.retry>=b)return void akeeba.Backup.endWithError(a);akeeba.Backup.resume.retry++,akeeba.Backup.resetRetryTimeoutBar();var c=akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPHALT_DESC"),d=akeeba.System.getOptions("akeeba.Backup.resume.timeout",10),e=c.replace("%d",d.toFixed(0));akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPHALT"),e),akeeba.Backup.resume.showWarnings="none"!==document.getElementById("backup-warnings-panel").style.display,document.getElementById("backup-progress-pane").style.display="none",document.getElementById("backup-warnings-panel").style.display="none",document.getElementById("error-panel").style.display="none",document.getElementById("backup-error-message-retry").textContent=a,document.getElementById("retry-panel").style.display="block",akeeba.Backup.startRetryTimeoutBar()},akeeba.Backup.endWithError=function(a){akeeba.Backup.resetTimeoutBar();var b=!1;document.getElementById("backup-progress-pane").style.display="none",document.getElementById("backup-warnings-panel").style.display="none",document.getElementById("retry-panel").style.display="none";var c=akeeba.System.getOptions("akeeba.Backup.URLs.LogURL"),d=akeeba.System.getOptions("akeeba.Backup.URLs.AliceURL"),e=c+"&tag="+akeeba.Backup.tag,f=d+"&log="+akeeba.Backup.tag;akeeba.Backup.backupid&&(e=e+"."+encodeURIComponent(akeeba.Backup.backupid),f=f+"."+encodeURIComponent(akeeba.Backup.backupid)),"finale"==akeeba.Backup.currentDomain&&(b=!0,f+="&autorun=1"),document.getElementById("ab-viewlog-error").setAttribute("href",e),document.getElementById("ab-alice-error").setAttribute("href",f),akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPFAILED"),a),akeeba.System.doAjax({ajax:"pushFail",tag:akeeba.Backup.tag,backupid:akeeba.Backup.backupid,errorMessage:a},function(){}),document.getElementById("backup-error-message").textContent=a,document.getElementById("error-panel").style.display="block",b&&setTimeout(function(){window.location=f},500)},akeeba.Backup.onDone=function(){var a=new Date;akeeba.System.notification.notify(akeeba.System.Text._("COM_AKEEBA_BACKUP_TEXT_BACKUPFINISHED")+" "+a.toLocaleString()),akeeba.Backup.resetTimeoutBar(),document.getElementById("backup-progress-pane").style.display="none",document.getElementById("backup-complete").style.display="block",document.getElementById("backup-warnings-panel").style.width="100%";var b=akeeba.System.getOptions("akeeba.Backup.URLs.LogURL"),c=b+"&tag="+akeeba.Backup.tag;akeeba.Backup.tag?akeeba.Backup.backupid&&(c=c+"."+encodeURIComponent(akeeba.Backup.backupid)):c=b+"&latest=1";try{document.getElementById("ab-viewlog-success").setAttribute("href",c)}catch(a){}if(akeeba.System.getOptions("akeeba.Backup.returnForm",!1))return void document.getElementById("returnForm").submit();var d=akeeba.System.getOptions("akeeba.Backup.returnUrl","");""!==d&&(window.location=d)},akeeba.Backup.restoreDefaultOptions=function(){document.getElementById("backup-description").value=akeeba.System.getOptions("akeeba.Backup.defaultDescription"),document.getElementById("comment").value="ThisIsADummyStringToWorkAroundChrome",document.getElementById("comment").value=""},akeeba.Backup.flipProfile=function(){document.getElementById("flipDescription").value=document.getElementById("backup-description").value,document.getElementById("flipComment").value=document.getElementById("comment").value,document.forms.profileForm.submit()},akeeba.System.documentReady(function(){akeeba.System.addEventListener("backup-start","click",function(a){return a.preventDefault(),akeeba.Backup.start(),!1}),akeeba.System.addEventListener("backup-default","click",function(a){return a.preventDefault(),akeeba.Backup.restoreDefaultOptions(),!1}),akeeba.System.addEventListener("comAkeebaBackupFlipProfile","click",function(a){return a.preventDefault(),akeeba.Backup.flipProfile(),!1}),akeeba.System.addEventListener("comAkeebaBackupResumeCancel","click",function(a){return a.preventDefault(),akeeba.Backup.cancelResume(),!1}),akeeba.System.addEventListener("comAkeebaBackupResume","click",function(a){return a.preventDefault(),akeeba.Backup.resumeBackup(),!1}),akeeba.System.addEventListener("profileId","change",akeeba.Backup.flipProfile),setTimeout(function(){akeeba.System.getOptions("akeeba.Backup.autoStart",!1)&&akeeba.Backup.start()},500),akeeba.System.notification.askPermission()});

//# sourceMappingURL=backup.min.js.map