{"version":3,"file":"s3import.min.js","names":["akeeba","S3Import","delayedApplicationOfS3KeysInGUI","elAccessKey","document","getElementById","elSecretKey","setTimeout","value","System","getOptions","resetRoot","changeDirectory","e","elTarget","target","encodedPrefix","data","get","atob","forms","adminForm","submit","importFile","encodedName","objectName","window","location","encodeURIComponent","documentReady","addEventListener","iterateNodes","el","redirectionURL"],"sources":["s3import.js"],"sourcesContent":["/**\n * @package   solo\n * @copyright Copyright (c)2014-2024 Nicholas K. Dionysopoulos / Akeeba Ltd\n * @license   GNU General Public License version 3, or later\n */\n\nif (typeof akeeba == \"undefined\")\n{\n    var akeeba = {};\n}\n\nif (typeof akeeba.S3Import == \"undefined\")\n{\n    akeeba.S3Import = {};\n}\n\nakeeba.S3Import.delayedApplicationOfS3KeysInGUI = function ()\n{\n    var elAccessKey = document.getElementById(\"s3access\");\n    var elSecretKey = document.getElementById(\"s3secret\");\n\n    if ((elAccessKey === null) || (elSecretKey === null))\n    {\n        return;\n    }\n\n    /**\n     * This makes sure that the S3 access and secret keys are not replaced by the browser or a password manager browser\n     * extensions with some arbitrary username and password combination.\n     */\n    setTimeout(function ()\n    {\n        document.getElementById(\"s3access\").value = akeeba.System.getOptions(\"akeeba.S3Import.accessKey\");\n        document.getElementById(\"s3secret\").value = akeeba.System.getOptions(\"akeeba.S3Import.secretKey\");\n    }, 500);\n};\n\n//=============================================================================\n// Akeeba Backup Pro - Import arbitrary archives from S3\n//=============================================================================\n\nakeeba.S3Import.resetRoot = function ()\n{\n    document.getElementById(\"ak_s3import_folder\").value = \"\";\n\n    return true;\n};\n\nakeeba.S3Import.changeDirectory = function (e)\n{\n    var elTarget      = e.target;\n    var encodedPrefix = akeeba.System.data.get(elTarget, \"s3prefix\", \"\");\n\n    document.getElementById(\"ak_s3import_folder\").value = atob(encodedPrefix);\n    document.forms.adminForm.submit();\n};\n\n/**\n *\n * @param {Event} e\n */\nakeeba.S3Import.importFile = function (e)\n{\n    var elTarget    = e.target;\n    var encodedName = akeeba.System.data.get(elTarget, \"s3object\", \"\");\n    var objectName  = atob(encodedName);\n\n    if (objectName === \"\")\n    {\n        return false;\n    }\n\n    window.location = akeeba.System.getOptions(\"akeeba.S3Import.importURL\") + \"&file=\" + encodeURIComponent(objectName);\n};\n\nakeeba.System.documentReady(function ()\n{\n    akeeba.S3Import.delayedApplicationOfS3KeysInGUI();\n\n    akeeba.System.addEventListener(\"akeebaS3ImportResetRoot\", \"click\", akeeba.S3Import.resetRoot);\n\n    akeeba.System.iterateNodes(\".akeebaS3ImportChangeDirectory\", function (el)\n    {\n        akeeba.System.addEventListener(el, \"click\", akeeba.S3Import.changeDirectory);\n    });\n\n    akeeba.System.iterateNodes(\".akeebaS3ImportObjectDownload\", function (el)\n    {\n        akeeba.System.addEventListener(el, \"click\", akeeba.S3Import.importFile);\n    });\n\n    var redirectionURL = akeeba.System.getOptions(\"akeeba.S3Import.autoRedirectURL\", \"\");\n\n    if (redirectionURL !== '')\n    {\n        window.location = redirectionURL;\n    }\n});\n"],"mappings":"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"}